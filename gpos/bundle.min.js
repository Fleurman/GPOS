const GPOS=(()=>{"use strict";function e(e,t,n,i){return{top:e,left:t,width:n,height:i}}function t(e){return"/gpos/assets/icons/"+e}function n(){fe.classList.remove("open"),ve.classList.remove("open")}function i(e){if(e.top=e.top<oe.FULLSCREEN+ie.OSBAR?oe.FULLSCREEN+ie.OSBAR:e.top,e.left=e.left<oe.FULLSCREEN?oe.FULLSCREEN:e.left,e.left+e.width>window.innerWidth-oe.FULLSCREEN){let t=e.left+e.width-(window.innerWidth-2*oe.FULLSCREEN);e.left=e.left-t}if(e.top+e.height>window.innerHeight-oe.FULLSCREEN-ie.OSBAR){let t=e.top+e.height-(window.innerHeight-ie.OSBAR-2*oe.FULLSCREEN);e.top=e.top-t}return e}function o(e){if(te)return e.classList.add("active"),void(e.infos&&e.infos.inFolder&&o(e.infos.folder.parentNode));if(!e.classList.contains("in-folder")||"true"!=e.dataset.mini)if("true"!=e.dataset.mini){var t=document.querySelectorAll("#pool > .openable[data-mini=false]"),n=parseInt(e.style.zIndex);for(let e=0;e<t.length;e++){t[e].classList.remove("active");let i=parseInt(t[e].style.zIndex);i>=n&&(t[e].style.zIndex=Math.max(0,i-1))}e.classList.add("active"),"true"!=e.dataset.mini&&(e.style.zIndex=t.length+2)}else pe.appendChild(e)}function a(e){e.add(this)}function r(){setTimeout(()=>{document.getElementById("GPOS").className="boot-end",setTimeout(()=>{document.getElementById("GPOS").className="booted"},1e3)},2500)}function l(e){let t=1,n=1;for(;e>t;)n+=1,t=n*(n+1)/2;let i=(e+(n%2==0?1:-1))%n;return{col:n-1,row:i}}function s(e,t){let n=l(t);e.style.left=96*(n.col-n.row)+"px",e.style.top=35+96*n.row+"px"}function d(e,t){let n=l(t);e.style.left=window.innerWidth-100-96*(n.col-n.row)+"px",e.style.top=35+96*n.row+"px"}function c(e,t){let n=l(t);e.style.left=96*(n.col-n.row)+"px",e.style.top=window.innerHeight-160-96*n.row+"px"}function p(e,t){let n=l(t);e.style.left=window.innerWidth-100-96*(n.col-n.row)+"px",e.style.top=window.innerHeight-160-96*n.row+"px"}function u(e){let t=void 0;switch(e.object){case"article":return t=f(e.icon),Z.newArticle(e.title,e.key,t);case"app":return Z.newApp(e.key);case"folder":let n=[];return e.items.forEach(e=>{n.push(u(e))}),t=f(e.icon),Z.newFolder(e.title,n,t);case"image":return Z.newImage(e.title,e.source,e.backColor);case"link":return t=f(e.icon),Z.newLink(e.title,e.url,t);default:return!1}}function m(){getJson("/desktop.json",!0).send().echo(e=>{let t={"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1};e.forEach(e=>{let n=u(e);if(n){switch(e.position){case"top-right":d(n,t[e.position]);break;case"bottom-left":c(n,t[e.position]);break;case"bottom-right":p(n,t[e.position]);break;case"top-left":default:e.position="top-left",s(n,t[e.position])}t[e.position]++}})})}function f(e){if(e)return"$"==e[0]?ne[e.substring(1)]:e}function h(e){THEMESETTINGS.wallpaper=e;let t="images/wallpaper/"+e+".png";Ee.innerHTML="body {background-image: url('"+t+"');}"}function v(e){THEMESETTINGS.color=e,ge.innerHTML=".open span#menuP,#menuhandle.open span#menuG,.openable.link > .win-icon::after {color:"+e+";}",ge.innerHTML+="div#GPOS::before {background-color:"+e+";}",ge.innerHTML+="#quickview {color:"+e+" !important;}",ge.innerHTML+="div#menuhandle:hover, .openable[data-mini='false'] > .win-title, .openable.system.active > .win-resize,.app-menu-handle:hover  {background-color:"+e+";}",ge.innerHTML+=".openable.system.active .win-content,.app-menu-handle:hover {border-color:"+e+";}"}function w(e){THEMESETTINGS.theme=e,be.innerHTML=ae[e].css}function E(){try{let e=de.read("THEMESETTINGS");e=JSON.parse(e),e.color&&v(e.color),e.theme&&w(e.theme),e.wallpaper&&h(e.wallpaper)}catch(e){console.log("ERROR WHILE LOADING USER THEME SETTINGS",e)}}function g(){let e=JSON.stringify(THEMESETTINGS);de.write("THEMESETTINGS",e)}function b(){de.remove("THEMESETTINGS")}function L(e="",t=""){let i=document.createElement("div");i.className="frame",EventListen(i);let a=function(){"true"==we.dataset.quickview&&(we.dataset.quickview="false"),o(i),n(),i.fireCustomEvent("focus")};i.addEventListener("mousedown",a),i.infos={title:e,mini:!1,lastWidth:ie.WINDOW,lastHeight:ie.WINDOW,iconTop:"",iconLeft:"",folder:pe,route:"",inFolder:!1},i.Title=document.createElement("div"),i.Title.className="win-title",i.Title.innerHTML=e,i.Title.dataset.title=e;let r,l=function(e){e.stopPropagation(),e.preventDefault(),i.fireCustomEvent("doubleclick")},s=!1,d=function(){i.dataset.notra=i.dataset.dragging=i.dataset.floating="false",s=!1,window.removeEventListener("mousemove",c,!1),window.removeEventListener("mouseup",d,!1),i.fireCustomEvent("moved")},c=function(e){if(e.preventDefault(),i.dataset.dragging="true",!(e.clientX<0||e.clientX>window.innerWidth||e.clientY<0||e.clientY>window.innerHeight)){var t=i.startLeft+e.clientX-i.startMX,n=i.startTop+e.clientY-i.startMY;t>=oe.FULLSCREEN&&t+ie.ICONWIDTH<=window.innerWidth-2*oe.FULLSCREEN&&(i.style.left=t/window.innerWidth*100+"%",i.infos.lastLeft=t),n>=oe.FULLSCREEN+ie.OSBAR&&n+ie.ICONHEIGHT<=window.innerHeight-2*oe.FULLSCREEN&&(i.style.top=n/window.innerHeight*100+"%",i.infos.lastTop=n),i.fireCustomEvent("moving")}},p=!1,u=e=>{if(a(),te)return clearTimeout(r),p=!1,void l(e);p?p&&(clearTimeout(r),p=!1,l(e)):("true"!=i.dataset.max&&m(e),r=setTimeout(function(){p=!1},400),p=!0)};i.Title.addEventListener("mousedown",u);let m=function(e){e.preventDefault(),s=!0,i.dataset.notra="true",i.startMX=e.clientX,i.startMY=e.clientY,i.startLeft=parseInt(document.defaultView.getComputedStyle(i).left,0),i.startTop=parseInt(document.defaultView.getComputedStyle(i).top,0);var t=function(){s=!1,i.Title.removeEventListener("mouseout",t)},n=function(){1==s&&(i.dataset.floating="true",i.Title.removeEventListener("mouseout",t),window.addEventListener("mousemove",c,!1)),s=!1};"true"==i.dataset.mini?i.classList.contains("in-folder")||setTimeout(n,200):(window.addEventListener("mousemove",c,!1),i.Title.addEventListener("mouseout",t,!1)),window.addEventListener("mouseup",d,!1)};return i.Content=document.createElement("div"),i.Content.className="win-content",i.Content.innerHTML=t,i.appendChild(i.Content),i.appendChild(i.Title),i}function y(e,t,i,a){let r=document.createElement("div");r.className="menu-item";let l=document.createElement("img");l.className="menu-item-icon",l.src=t;let s=document.createElement("span");return s.className="menu-item-title",s.innerText=e,r.appendChild(l),r.appendChild(s),r.addEventListener("mousedown",t=>{if(0!=t.button)return;n();let r=document.getElementById(a);if(r)r.restore(),o(r);else{let t=Z.newSystem(e,i,a);o(t)}}),r}function x(){let e=document.createElement("div");return e.className="loading-indicator",e}function T(t,n,r){let l=new L(t,n);l.dataset.mini="true",Se(l),Ie(l),ke(l),l.classList.add("openable"),l.infos={title:t,mini:!1,lastWidth:ie.WINDOW,lastHeight:ie.WINDOW,iconTop:"",iconLeft:"",folder:pe,route:"",inFolder:!1},l.setFolder=function(e,t){l.classList.add("in-folder"),l.dataset.route=t,l.infos.route=t,l.infos.folder=e,l.infos.inFolder=!0,l.Title.dataset.route=t},l.displace=a,l.placeholder=function(){let e=document.createElement("div");e.className="placeholder",e.innerHTML='<img src="'+r+'">',e.dataset.title=t,l.insertAdjacentElement("beforebegin",e),l.infos.placeholder=e};let s=t=>{if("true"==l.dataset.mini){l.infos.inFolder?l.placeholder(l.infos.folder):(l.holder=document.createElement("meta"),l.insertAdjacentElement("beforebegin",l.holder)),l.displace(we),l.infos.iconTop=l.style.top,l.infos.iconLeft=l.style.left;let t=e(MOUSE.Y-30,MOUSE.X-30,l.infos.lastWidth?l.infos.lastWidth:ie.WINDOW,l.infos.lastHeight?l.infos.lastHeight:ie.WINDOW);t=i(t),l.style.top=t.top+"px",l.style.left=t.left+"px",setTimeout(function(){l.dataset.mini=!1,l.infos.mini=!1,l.style.width=t.width+"px",l.style.height=t.height+"px",o(l)},10)}};return l.addCustomEventListener("doubleclick",s),l.Icon=document.createElement("div"),l.Icon.className="win-icon",l.Icon.innerHTML='<img src="'+r+'">',l.Title.insertAdjacentElement("beforebegin",l.Icon),l}function C(e,t,n="black"){let i=new T(e,`<div class="image-container"><img src="${t}" alt="Image"></div>`,t);return i.classList.add("image"),Ne(i),i.dataset.backColor=n,i}function N(e,t,n=ne.ARTICLE){let i=new T(e,x(),n);return i.classList.add("article"),i.Content.classList.add("meno"),i.addCustomEventListener("doubleclick",()=>{loadMenoTo(i.Content,I(t))}),i}function I(e){return"/articles/"+e+".txt"}function S(e,t,n=ne.FOLDER){let i=new T(e,"",n);return i.classList.add("folder"),Ce(i),i.add=function(e){i.Content.appendChild(e)},t.forEach(t=>{i.add(t),t.setFolder(i.Content,e+"/")}),i}function k(e,t){let n=new L(e,"");return n.dataset.mini="true",n.classList.add("openable"),n.infos={title:e,iconTop:"",iconLeft:"",folder:pe,route:"",inFolder:!1},n.setFolder=function(e,t){n.classList.add("in-folder"),n.dataset.route=t,n.infos.route=t,n.infos.folder=e,n.infos.inFolder=!0,n.Title.dataset.route=t},n.displace=a,n.Icon=document.createElement("div"),n.Icon.className="win-icon",n.Icon.innerHTML='<img src="'+t+'">',n.Title.insertAdjacentElement("beforebegin",n.Icon),n}function O(e,t,n){let i=new k(e,t);i.classList.add("link");let o=()=>{window.open(n,"_blank")};return i.addCustomEventListener("doubleclick",o),i}function M(e){let t=Q(e);t.id=e;let n="/apps/"+e+"/",i=new k(t.title,n+t.icon);i.classList.add("app"),t.devices&&(t.devices.includes("desktop")||i.classList.add("no-desktop"),t.devices.includes("tablet")||i.classList.add("no-tablet"),t.devices.includes("mobile")||i.classList.add("no-mobile"));let o=()=>{V(t)};return i.addCustomEventListener("doubleclick",o),i}function R(e,t,n){let i=new L(e,"");Te(i),Ie(i),ke(i),i.id=n,i.classList.add("system","openable"),i.dataset.mini="false",i.Content.appendChild(t);let o=()=>{i.dataset.closed="true",i.style.pointerEvents="none",i.style.opacity=0,i.style.width="0px",i.style.height="0px",i.style.top="0px",i.style.left="0px"};i.close=o,i.close=o;let a=()=>{i.dataset.closed="false",i.style.pointerEvents="all",i.style.opacity=1,i.style.width=(i.infos.lastWidth||ie.WINDOW)+"px",i.style.height=(i.infos.lastHeight||ie.WINDOW)+"px",i.style.top=(i.infos.lastTop||"40")+"px",i.style.left=(i.infos.lastLeft||"40")+"px"};return i.restore=a,i.addCustomEventListener("close",o),i}function H(e,t){let n=new L(e,t);n.classList.add("information","openable"),n.dataset.mini="false",Te(n);let i=()=>{n.remove()};return n.addCustomEventListener("closed",i),n}function A(e){e.element.style.pointerEvents="none",e.element.style.transition="opacity 0.4s",e.element.style.opacity="0",setTimeout(()=>{e.element.remove()},400)}function W(e,t){let n=F({label:"Quitter"});return n.addEventListener("click",n=>{0==n.button&&(t.style.pointerEvents="none",t.style.transition="opacity 0.4s",t.style.opacity="0",setTimeout(()=>{t.remove()},400),e.close?(e.close(A.bind(null,e)),j(e.id),0==Z.appInstancesOf(e.id)&&X(e.id)):(A(e),j(e.id),0==Z.appInstancesOf(e.id)&&X(e.id)))}),n}function F(e){let t=document.createElement("div");t.className="app-menu-item";let n=document.createElement("span");return n.className="app-menu-item-label",n.innerText=e.label,t.appendChild(n),t}function G(e){let t=document.createElement("div");t.className="app-menu-text";let n=document.createElement("span");return n.className="app-menu-item-label",n.innerText=e.label,t.appendChild(n),t}function D(){let e=document.createElement("div");e.className="app-menu-text";let t=document.createElement("span");return t.className="app-menu-hr",e.appendChild(t),e}function q(e){let t=F(e);t.classList.add("app-menu-function"),t.addEventListener("click",t=>{0==t.button&&e.function&&e.function()})}function U(e,t){let n=F(e);return n.classList.add("app-menu-info"),n.addEventListener("click",n=>{if(0!=n.button)return;t.classList.remove("open");let i=e.id+":"+e.label,a=document.getElementById(i);a||(a=Z.newInformation(e.title,e.content),a.id=i),o(a)}),n}function B(e,t){let n=F(e);return n.classList.add("app-menu-window"),n.addEventListener("click",n=>{if(0!=n.button)return;t.classList.remove("open");let i=e.id+":"+e.label,a=document.getElementById(i);a||(a=Z.newSystem(e.title,e.content),a.id=i),a.restore(),o(a)}),n}function z(e){let t=F(e),n=document.createElement("span");n.className="app-menu-item-state",t.appendChild(n);let i=e=>!0===e?"☑":!1===e?"☐":e;if(void 0!==e.value){let t=i(e.value);n.innerHTML=t}return t.addEventListener("click",t=>{0==t.button&&e.function&&(n.innerHTML=i(e.function()))}),t}function _(e,t){let n=void 0;switch(e.type){case"text":n=G(e);break;case"line":n=D();break;case"function":n=q(e);break;case"switch":n=z(e);break;case"information":n=U(e,t);break;case"window":n=B(e,t)}return e.ref&&e.ref(n),n}function P(e){let t=document.createElement("div");t.className="app-menu-handle";let n=document.createElement("img");n.className="app-menu-icon",n.src=`${K(e.id)+e.icon}`,t.appendChild(n),n.addEventListener("mouseup",e=>{if(e.target!=n)return;if(0!=e.button)return;i.classList.toggle("open");let t=e=>{e.path.includes(i)||(i.classList.remove("open"),window.removeEventListener("mousedown",t))};window.addEventListener("mousedown",t)});let i=document.createElement("div");i.className="app-menu-cont",e.menu&&e.menu.forEach(e=>{i.appendChild(_(e,i))}),i.appendChild(W(e,t)),t.appendChild(i),me.appendChild(t)}function j(e){if(Z.AppRegistery[e]){let t=Math.max(0,Z.AppRegistery[e].instances-1);return Z.AppRegistery[e].instances=t,Z.AppRegistery[e]}return console.warn("The App '"+e+"' isn't registered !"),!1}function $(e,t){if(0==Z.AppRegistery[e].instances){let n=document.createElement("style");n.dataset.appid=e,n.innerHTML=t.style,document.head.appendChild(n)}}function X(e){let t=document.head.querySelector(`style[data-appid='${e}']`);t&&t.remove()}function Y(e){return 1==e.multiple||(!!(Number.isInteger(e.multiple)&&e.multiple>Z.appInstancesOf(e.id))||0==e.multiple&&0==Z.appInstancesOf(e.id))}function J(e){var t=document.getElementById("GPOS");let n=Z.getApp(e.id);if(n){let i=n.id,o=n.function(i);Object.assign(o,e),o.style&&$(e.id,o),o.element.dataset.appid=e.id,o.element.dataset.instance=i,o.element.classList.add("application"),n.instances++,t.appendChild(o.element),P(o),o.start&&o.start()}}function V(e){if(!Y(e))return;if(document.head.querySelector(`script[data-appid='${e.id}']`))return void J(e);let t="/apps/"+e.id+"/app.js";var n=document.createElement("script");n.dataset.appid=e.id,n.onerror=(e=>{alert(e)}),n.onload=(()=>{J(e)}),document.head.appendChild(n),n.src=t}function K(e){return"/apps/"+e+"/"}function Q(e){let t=!1;return getJson(K(e)+"app.json",!0).send().echo(e=>{e.icon||(e.icon="icon.png"),t=e}),t}var Z={},ee=function(){this.parentNode.removeChild(this)};Text.prototype.remove||(Text.prototype.remove=ee),Element.prototype.remove||(Element.prototype.remove=ee),Math.randomInt=function(e){return Math.ceil(Math.random()*e)},"path"in Event.prototype||Object.defineProperty(Event.prototype,"path",{get:function(){const e=[];let t=this.target;for(;t;)e.push(t),t=t.parentElement;return-1===e.indexOf(window)&&-1===e.indexOf(document)&&e.push(document),-1===e.indexOf(window)&&e.push(window),e}}),window.EventListen=function(e=this){e.events={},e.addCustomEventListener=function(t,n){e.events[t]=e.events[t]||[],e.events[t].push(n)},e.removeCustomEventListener=function(t,n){if(void 0!==e.events[t]){let i=e.events[t];for(let e=0;e<i.length;e++){const t=i[e];if(t==n){i.splice(e,1);break}}}},e.fireCustomEvent=function(t,n){e.events[t]&&e.events[t].forEach(e=>{e.call(this,n)})}},window.Future=function(e){EventListen(this);var t=e||null;Object.defineProperty(this,"value",{get:()=>t,set(e){this.fireCustomEvent("value",new MessageEvent("future",{data:e})),t=e,o()},enumerable:!0,configurable:!0});var n=function(e){t=e},i=[],o=function(){for(let e=0;e<i.length;e++){let o=i[e](t,n);if(!1===o)break;"number"==typeof o&&(e=e+o<0?0:e+o)}};this.echo=function(e){i=[],i.push(e);let t={then:a.bind(this)};return null!=this.value&&o(),t};var a=function(e){i.push(e);let t={then:a.bind(this)};return null!=this.value&&o(),t}},window.Request=function(e,t){t=t||!1;var n={};return n.req=new XMLHttpRequest,n.Future=new Future,n.onLoaded=function(){},n.loaded=function(e){return n.onLoaded=e,n},n.processResponse=function(e){return e},n.req.onload=function(e){if(200===this.status)try{n.Future.value=n.processResponse(this),n.onLoaded(n.Future.value)}catch(e){n.onFailed()}else n.onFailed(e)},n.onFailed=function(){},n.failed=function(e){return n.onFailed=e,n},n.req.onerror=function(t){console.error("Ajax Error "+t.target.status+" from "+e),n.onFailed(t)},n.send=function(){return n.req.open("GET",e,!t),n.req.send(null),n.Future},n},window.fhtml=function(e){return e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e},window.getJson=function(e,t){var n=Request(e,t);return n.processResponse=function(e){return JSON.parse(e.responseText)},n},window.getText=function(e,t){var n=Request(e,t);return n.processResponse=function(e){return e.responseText},n},window.loadMenoTo=function(e,t){getText(t).send().echo(t=>{e.innerHTML=meno.parsed(t)})};var te=window.matchMedia("(max-width: 860px)").matches,ne={ARTICLE:t("text.png"),TEXT:t("text.png"),DEV:t("dev.png"),FOLDER:t("box.png"),SYSTEM:t("system.png"),THEME:t("theme.png"),NOTEPAD:t("notepad.png"),SOUND:t("sound.png"),ZIP:t("zip.png"),BOX:t("box.png"),INFO:t("information.png"),CASE:t("case.png"),RANDOM:t("random.png"),BOOK:t("book.png"),DRAGON:t("dragon.png")},ie={OSBAR:30,ICONWIDTH:64,ICONHEIGHT:64,WINDOW:384,WINDOW_MIN:288},oe={FULLSCREEN:2,DESKTOP:10};window.MOUSE={x:0,y:0},window.addEventListener("mousemove",e=>{MOUSE.X=e.clientX,MOUSE.Y=e.clientY}),window.THEMESETTINGS={};var ae={gpos:"",bubble:{css:".openable[data-mini='false']>.win-title {\n\t\t\tborder-radius: 20px;\n\t\t\tbackground-image: linear-gradient(177deg, rgba(255, 255, 255, 0.4), transparent, rgba(0, 0, 0, 0.1));\n\t\t\tbox-shadow: 1px 1px 3px #000;\n\t\t\tposition: absolute;\n\t\t\tleft: 0;\n\t\t\tright: 0;\n\t\t}\n\t\t\n\t\t.openable {\n\t\t\tbackground: none;\n\t\t\tborder: none;\n\t\t\tbox-shadow: none;\n\t\t\toverflow: visible;\n\t\t}\n\t\t\n\t\t.openable .win-content {\n\t\t\tborder-radius: 20px;\n\t\t\tborder-top-left-radius: 0;\n\t\t\tmargin-left: 10px;\n\t\t\tborder-top-right-radius: 0;\n\t\t\tmargin-right: 10px;\n\t\t\tbox-shadow: 1px 1px 5px;\n\t\t}\n\t\t\n\t\t.win-resize {\n\t\t\tborder-radius: 50%;\n\t\t\tbackground-color: #fff;\n\t\t\tborder: 2px solid #eee;\n\t\t\tbox-shadow: -1px -1px 3px #000;\n\t\t}\n\t\t\n\t\t.openable[data-mini='true'] {\n\t\t\tborder-radius: 50%;\n\t\t}\n\t\t\n\t\t[data-mini='true'] .win-icon {\n\t\t\tborder-radius: 50%;\n\t\t\tpadding: 4px;\n\t\t\tbox-sizing: border-box;\n\t\t\tbox-shadow: 1px 1px 3px;\n\t\t}\n\t\t\n\t\t.openable .win-icon img {\n\t\t\tborder-radius: 50%;\n\t\t}\n\t\t\n\t\t.openable.shortcut .win-icon::after {\n\t\t\tborder-radius: 50%;\n\t\t\tleft: 2px;\n\t\t\tbottom: 2px;\n\t\t}\n\t\t\n\t\t.placeholder {\n\t\t\tborder-radius: 50%;\n\t\t}\n\t\t\n\t\t#pool .openable[data-mini='false']:not(.active) {\n\t\t\tbox-shadow: none !important;\n\t\t}\n\t\t\n\t\t#pool .openable[data-mini='false']:not(.active) .win-content {\n\t\t\tbox-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3) !important;\n\t\t\tborder-color: #eee;\n\t\t}\n\t\t:not([data-view='list'])>.win-content>.openable[data-mini='true'] {\n\t\t\tborder-radius: 50%;\n\t\t\tbackground-color: rgba(0, 0, 0, 0.1);\n\t\t}",icons:{close:"⊗",min:"◴",max:"○",unmax:"⌾",viewgrid:"⊕",viewlist:"⊖"}},nostalgy:{css:'.openable {\n\t\t\tborder-radius: 0;\n\t\t\tborder-width: 2px;\n\t\t\tborder-color: #fff;\n\t\t\tborder-style: outset;\n\t\t\tbox-shadow: 1px 1px 0 #000;\n\t\t}\n\t\t\n\t\t.openable[data-mini=\'false\']>.win-title {\n\t\t\tborder-bottom: 1px solid #000;\n\t\t\theight: 15px;\n\t\t}\n\t\t\n\t\tbody {\n\t\t\tfont-family: monospace;\n\t\t}\n\t\t\n\t\t.openable[data-mini="true"]:not(.trans):hover {\n\t\t\tborder-radius: 0;\n\t\t}\n\t\t\n\t\t.openable[data-mini="true"]:not(.trans) {\n\t\t\ttransition: none;\n\t\t}\n\t\t\n\t\t.win-resize {\n\t\t\tborder: 1px solid grey;\n\t\t\tborder-radius: 0;\n\t\t\tborder-bottom: none;\n\t\t\tborder-right: none;\n\t\t\theight: 10px;\n\t\t\twidth: 10px;\n\t\t}\n\t\t\n\t\t.win-resize:hover {\n\t\t\tbackground-color: inherit;\n\t\t}\n\t\t\n\t\t.openable.shortcut .win-icon::after {\n\t\t\tborder-radius: 0;\n\t\t\tbackground-color: #fff;\n\t\t\tfont-weight: bold;\n\t\t}\n\t\t\n\t\t.openable[data-mini="true"] .win-title::after {\n\t\t\ttext-shadow: 1px 1px 0 #000;\n\t\t\tfont-size: 14px;\n\t\t}\n\t\t\n\t\t.system-button {\n\t\t\tborder: 2px outset;\n\t\t}\n\t\t\n\t\tdiv#menuhandle {\n\t\t\tbackground-color: #ddd;\n\t\t\tborder: 2px outset;\n\t\t\tcolor: #000;\n\t\t\tmargin: 2px;\n\t\t\theight: 26px;\n\t\t\tmargin-top: 0;\n\t\t}\n\t\t\n\t\tdiv#menu {\n\t\t\tborder-radius: 0;\n\t\t\tbox-shadow: 1px1px0#000;\n\t\t}\n\t\t\n\t\tdiv#menu.open {\n\t\t\tborder-width: 2px;\n\t\t}\n\t\t\n\t\tdiv#osbar {\n\t\t\tbackground-image: none;\n\t\t\tbackground-color: #eee;\n\t\t\theight: 30px;\n\t\t\tborder-bottom: 4px ridge;\n\t\t}\n\t\t\n\t\t.win-min, .win-max, .win-folder-view,.win-back-color {\n\t\t\tbackground-color: yellow;\n\t\t\tpadding: 0px!important;\n\t\t\tmargin: 3px;\n\t\t\tborder: 2px outset;\n\t\t\tfont-size: 12px !important;\n\t\t}\n\t\t\n\t\t.win-max {\n\t\t\tbackground-color: greenyellow;\n\t\t}\n\t\t\n\t\t.win-close {\n\t\t\tbackground-color: lightsalmon;\n\t\t}\n\t\t\n\t\t.win-folder-view,.win-back-color {\n\t\t\tbackground-color: whitesmoke;\n\t\t}\n\t\t\n\t\t.win-min.win-close {\n\t\t\tfont-size: 10px!important;\n\t\t\tline-height: 15px;\n\t\t}\n\t\t\n\t\t.win-min:hover, .win-max:hover, .win-folder-view:hover,.win-back-color:hover {\n\t\t\tcolor: #000;\n\t\t\tbackground-color: #fff\n\t\t}\n\t\t\n\t\tdiv#quickview {\n\t\t\tcolor: #888;\n\t\t}\n\t\t\n\t\tdiv#menuGPBox {\n\t\t\tposition: relative;\n\t\t\ttransform: scale(0.8);\n\t\t\ttop: -2px;\n\t\t}\n\t\t\n\t\t.app-menu-handle {\n\t\t\tborder: 2px outset #fff !important;\n\t\t\theight:28px;\n\t\t\twidth:28px;\n\t\t}\n\t\t.app-menu-handle img{\n\t\t\theight:20px;\n\t\t\twidth:20px;\n\t\t\tmargin:2px;\n\t\t}'}},re=["face","face2","face3","Forest","Spider","Tome 3"],le=["yellowgreen","darkkhaki","darkseagreen","cadetblue","darkturquoise","cornflowerblue","mediumslateblue","darkorchid","mediumvioletred","orchid","hotpink","lightcoral","palevioletred","crimson","orangered","salmon","indianred","peru","burlywood","orange","darkgrey"];const se=(e,t)=>{let n={},i={};return n.read=function(n){if(i[n])return i[n];try{let i=e.getItem("M_"+n);if(i)return i}catch(e){console.warn(`ERROR WHILE READING ${t} [${n}]`,e)}return!1},n.get=n.read,n.write=function(n,o){try{e.setItem("M_"+n,o),i[n]=o}catch(e){console.warn(`ERROR WHILE WRITING IN ${t} [${n} = ${o}]`,e)}},n.remove=function(n){try{e.removeItem("M_"+n),i[n]=void 0}catch(e){console.warn(`ERROR WHILE REMOVING ${t} ITEM [${n}]`,e)}},n};var de=se(localStorage,"MEMORY"),ce=(se(sessionStorage,"SESSION"),document.getElementById("GPOS")),pe=document.createElement("div");pe.id="desktop",pe.add=function(e){this.appendChild(e)},ce.appendChild(pe);var ue=document.createElement("div");ue.id="osbar",ce.appendChild(ue);var me=document.createElement("div");me.id="appsbar",ue.appendChild(me);var fe=document.createElement("div");fe.id="menuhandle",fe.innerHTML='<div id="menuGPBox"><span id="menuG"></span><span id="menuP"></span><div>',fe.addEventListener("click",e=>{fe.classList.toggle("open"),ve.classList.toggle("open");let t=e=>{e.path.includes(fe)||n(),window.removeEventListener("mousedown",t)};window.addEventListener("mousedown",t)}),ue.appendChild(fe);var he=document.createElement("div");he.id="quickview",he.innerHTML="∷",he.addEventListener("click",e=>{we.classList.add("quickview")}),ue.appendChild(he);var ve=document.createElement("div");ve.id="menu",fe.appendChild(ve);var we=document.createElement("div");we.id="pool",we.add=function(e){this.appendChild(e)},ce.appendChild(we),we.addEventListener("click",e=>{we.classList.remove("quickview")}),ce.appendChild(we),te&&we.addEventListener("click",e=>{e.target==we&&[].forEach.call(pool.children,e=>{e.classList.remove("active")})});var Ee=document.createElement("style");document.head.appendChild(Ee);var ge=document.createElement("style");document.head.appendChild(ge);var be=document.createElement("style");document.head.appendChild(be),E();var Le=function(){function e(e){return e==n?"selected":""}let t=document.createElement("form");t.className="system-form",t.action="#",t.innerHTML+='<label for="_theme_choice">Thème:</label>';let n=THEMESETTINGS.theme||"",i=document.createElement("select");i.id=i.name="_theme_choice",i.innerHTML=`<option value="gpos" ${e("gpos")}>GPOS</option>\n\t<option value="bubble" ${e("bubble")}>Bubble</option>\n\t<option value="nostalgy" ${e("nostalgy")}>Nostalgy</option>`,i.addEventListener("change",e=>{w(i.value),g()}),t.appendChild(i),THEMESETTINGS.theme&&(i.selectedIndex=Object.keys(ae).indexOf(THEMESETTINGS.theme));let o=document.createElement("label");o.innerText="Wallpaper:",o.for="_wallpaper_choice",t.appendChild(o);let a=document.createElement("div");a.id="_wallpaper_choice",re.forEach(e=>{let t=document.createElement("img");t.src="images/wallpaper/"+e+".png",t.dataset.value=e,THEMESETTINGS.wallpaper==e&&t.classList.add("selected"),t.addEventListener("click",n=>{h(e),g(),a.querySelectorAll("img").forEach(e=>{e.classList.remove("selected")}),t.classList.add("selected")});let n=document.createElement("div");n.className="wallpaper-choice",n.title=e,n.appendChild(t),a.appendChild(n)}),t.appendChild(a);let r=document.createElement("label");r.innerText="Main Color:",r.for="_color_choice",t.appendChild(r);let l=document.createElement("div");l.id="_color_choice",le.forEach(e=>{let t=document.createElement("div");t.className="color-choice",t.style.backgroundColor=e,t.title=e,t.dataset.value=e,THEMESETTINGS.color==e&&t.classList.add("selected"),t.addEventListener("click",n=>{v(e),g(),l.querySelectorAll(".color-choice").forEach(e=>{e.classList.remove("selected")}),t.classList.add("selected")}),l.appendChild(t),THEMESETTINGS.color&&THEMESETTINGS.color==e&&t.classList.add("selected")}),t.appendChild(l);let s=document.createElement("div");return s.innerText="Default",s.className="system-button",s.addEventListener("click",e=>{w("gpos"),i.selectedIndex=0,l.querySelector("[data-value='orangered']").click(),a.querySelector("[data-value='face2']").click(),b()}),t.appendChild(s),t}(),ye=function(){let e=document.createElement("form");e.className="notepad-form",e.action="#",e.dataset.max=2e3;let t=document.createElement("textarea");t.id="_note_area",t.maxLength=e.dataset.max,t.spellcheck=!1,e.appendChild(t);let n=de.read("note")||"Ceci est un bloc-note.";t.innerHTML=n;let i=function(){de.write("note",t.value)};t.addEventListener("blur",i),t.addEventListener("keyup",i);let o=function(){let n=t.value;e.dataset.count=n.length,n.length==t.maxLength?e.classList.add("full"):e.classList.remove("full")};return t.addEventListener("keyup",o),o(),e}(),xe=function(){let e=document.createElement("div");return e.className="meno",loadMenoTo(e,"/articles/about.txt"),e}();document.addEventListener("keydown",e=>{if(e.ctrlKey&&"KeyA"==e.code){e.preventDefault();let t=document.querySelector("#pool > .openable.active");if(t){let e=t.querySelector(".win-content:first-of-type"),n=document.getSelection();n.selectAllChildren(e)}}});var Te=e=>{let t=document.createElement("div");t.className="win-min win-close",t.addEventListener("click",()=>{e.dataset.max="false",e.fireCustomEvent("close"),e.style.opacity=0,e.classList.add("trans"),setTimeout(function(){e.classList.remove("trans"),e.fireCustomEvent("closed")},500)}),e.appendChild(t)},Ce=e=>{let t=document.createElement("div");t.className="win-folder-view",t.addEventListener("click",()=>{"true"!=e.dataset.mini&&(e.fireCustomEvent("viewchange"),"list"==e.dataset.view?e.dataset.view="icons":e.dataset.view="list",e.fireCustomEvent("viewchanged"))}),e.appendChild(t)},Ne=e=>{let t=document.createElement("div");t.className="win-back-color",t.addEventListener("click",()=>{"true"!=e.dataset.mini&&(e.fireCustomEvent("backcolorchange"),"white"==e.dataset.backColor?e.dataset.backColor="black":e.dataset.backColor="white",e.fireCustomEvent("backcolorchanged"))}),e.appendChild(t)},Ie=e=>{let t=document.createElement("div");t.className="win-max";let n=()=>{e.dataset.max="false";let t=e.infos.oldRect;e.style.top=t[0],e.style.left=t[1],e.style.width=t[2],e.style.height=t[3]},i=()=>{e.dataset.max="true",e.infos.oldRect=[e.style.top,e.style.left,e.style.width,e.style.height],e.style.top=ie.OSBAR+"px",e.style.left="0px",e.style.width=window.innerWidth-2+"px",e.style.height=window.innerHeight-2-ie.OSBAR+"px"};t.addEventListener("click",()=>{"true"!=e.dataset.mini&&("true"==e.dataset.max?(e.fireCustomEvent("unmaximize"),n(),e.fireCustomEvent("unmaximized")):(e.fireCustomEvent("maximize"),i(),e.fireCustomEvent("maximized")))}),e.appendChild(t)},Se=e=>{let t=document.createElement("div");t.className="win-min win-close";let n=()=>{e.dataset.mini="true",e.dataset.max="false",e.style.width=ie.ICONWIDTH+"px",e.style.height=ie.ICONHEIGHT+"px",e.infos.inFolder||(e.style.top=e.infos.iconTop,e.style.left=e.infos.iconLeft)};t.addEventListener("click",()=>{if("true"!=e.dataset.mini){n(),e.fireCustomEvent("close"),e.classList.add("trans");let t=te&&e.holder?0:e.infos.inFolder?100:300;setTimeout(function(){e.classList.remove("trans"),e.infos.inFolder?(e.infos.placeholder.insertAdjacentElement("beforebegin",e),e.infos.placeholder.remove()):e.holder?(e.holder.insertAdjacentElement("afterend",e),e.holder.remove()):e.displace(e.infos.folder)},t)}}),e.appendChild(t)},ke=e=>{let t,i,a,r,l=document.createElement("div");l.className="win-resize";let s=l=>{l.preventDefault(),e.fireCustomEvent("resize"),o(e),n(),e.dataset.notra="true",a=l.clientX,r=l.clientY,t=parseInt(document.defaultView.getComputedStyle(e).width,10),i=parseInt(document.defaultView.getComputedStyle(e).height,10),window.addEventListener("mousemove",d,!1),window.addEventListener("mouseup",c,!1)},d=n=>{let o=t+MOUSE.X-a,l=i+MOUSE.Y-r;o>ie.WINDOW_MIN&&o<window.innerWidth-2*oe.FULLSCREEN&&(e.style.width=o+"px",e.infos.lastWidth=o),l>ie.WINDOW_MIN&&l<window.innerHeight-ie.OSBAR-2*oe.FULLSCREEN&&(e.style.height=l+"px",e.infos.lastHeight=l),e.fireCustomEvent("resizing")},c=t=>{e.dataset.notra="false",window.removeEventListener("mousemove",d,!1),window.removeEventListener("mouseup",c,!1),e.fireCustomEvent("resized")};l.addEventListener("mousedown",s),e.appendChild(l)};return Z.newImage=((e,t,n)=>pe.appendChild(new C(e,t,n))),Z.newArticle=((e,t,n)=>pe.appendChild(new N(e,t,n))),Z.newFolder=((e,t,n)=>pe.appendChild(new S(e,t,n))),Z.newLink=((e,t,n)=>pe.appendChild(new O(e,n,t))),Z.newApp=(e=>pe.appendChild(new M(e))),Z.newSystem=((e,t,n)=>{let i=new R(e,t,n);return i.close(),we.appendChild(i),setTimeout(()=>{i.restore()},10),i}),Z.newInformation=((e,t)=>{let n=new H(e,t);return we.appendChild(n),n.style.left=(window.innerWidth-n.offsetWidth)/2+"px",n.style.top=(window.innerHeight-n.offsetHeight)/2+"px",n}),Z.AppRegistery={},Z.registerApp=function(e,t){Z.AppRegistery[e]={id:0,function:t,instances:0}},Z.getApp=function(e){return Z.AppRegistery[e]?(Z.AppRegistery[e].id++,Z.AppRegistery[e]):(console.warn("The App '"+e+"' isn't registered !"),!1)},Z.appInstancesOf=function(e){return Z.AppRegistery[e]?Z.AppRegistery[e].instances:0},Z.flushAppInstance=function(e){return Z.AppRegistery[e]?(Z.AppRegistery[e].instances--,Z.AppRegistery[e]):(console.warn("The App '"+e+"' isn't registered !"),!1)},ve.appendChild(y("Thème & Apparence",ne.THEME,Le,"gpos-themes")),ve.appendChild(y("Bloc-note",ne.NOTEPAD,ye,"gpos-notepad")),ve.appendChild(y("À propos",ne.INFO,xe,"gpos-about")),m(),r(),Z})();